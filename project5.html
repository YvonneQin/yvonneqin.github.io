
<!DOCTYPE html>
<html lang="en">

<head>
  <meta name="author" content="yuwen">
  <meta charset="UTF-8"/> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
  <link rel="stylesheet" href="css/main.css"/>
  <link rel="stylesheet" href="css/rad-icons.css"/>
  <link rel="stylesheet" href="css/custom.css"/>

  <script>
      (function (w, d, s, l, i) {
          w[l] = w[l] || [];
          w[l].push({
              'gtm.start': new Date().getTime(),
              event: 'gtm.js'
          });
          var f = d.getElementsByTagName(s)[0],
              j = d.createElement(s),
              dl = l != 'dataLayer' ? '&l=' + l : '';
          j.async = true;
          j.src =
              'https://www.googletagmanager.com/gtm.js?id=GTM-000000' + i + dl;
          f.parentNode.insertBefore(j, f);
      })(window, document, 'script', 'dataLayer', 'GTM-000000');
  </script>

  <title>Python批量处理生命力评估模型</title>
  <style> 
      
      .rad-fade-in {
          will-change: opacity, transform;
          animation-name: rad-fade-in-fallback;
          animation-duration: 5s;
          animation-fill-mode: both;
      }

      @keyframes rad-fade-in-fallback {
          0% {
              opacity: 0;
          }

          75% {
              opacity: 0;
          }

          100% {
              opacity: 1;
          }
      }

      .fonts-loaded .rad-fade-in.rad-waiting {
          animation-name: none;
          opacity: 0;
      }

      .fonts-loaded .rad-fade-in.rad-animate {
          animation-name: rad-fade-in;
          animation-duration: 1.1s;
          animation-fill-mode: both;
      }

      @keyframes rad-fade-in {
          0% {
              opacity: 0;
          }

          100% {
              opacity: 1;
          }
      }

      
      .rad-fade-in-long {
          will-change: opacity, transform;
          animation-name: rad-fade-in-long-fallback;
          animation-duration: 8s;
          animation-fill-mode: both;
      }

      @keyframes rad-fade-in-long-fallback {
          0% {
              opacity: 0;
          }

          75% {
              opacity: 0;
          }

          100% {
              opacity: 1;
          }
      }

      .fonts-loaded .rad-fade-in-long.rad-waiting {
          animation-name: none;
          opacity: 0;
      }

      .fonts-loaded .rad-fade-in-long.rad-animate {
          animation-name: rad-fade-in-long;
          animation-duration: 2s;
          animation-fill-mode: both;
      }

      @keyframes rad-fade-in-long {
          0% {
              opacity: 0;
          }

          20% {
              opacity: 0;
          }

          100% {
              opacity: 1;
          }
      }

      
      .rad-fade-down {
          will-change: opacity, transform;
          animation-name: rad-fade-down-fallback;
          animation-duration: 5s;
          animation-fill-mode: both;
          transform: translateY(-30px);
      }

      @keyframes rad-fade-down-fallback {
          0% {
              opacity: 0;
              transform: translateY(-30px);
          }

          75% {
              opacity: 0;
              transform: translateY(-30px);
          }

          100% {
              opacity: 1;
              transform: translateY(0);
          }
      }

      .fonts-loaded .rad-fade-down.rad-waiting {
          animation-name: none;
          opacity: 0;
          transform: translateY(-30px);
      }

      .fonts-loaded .rad-fade-down.rad-animate {
          animation-name: rad-fade-down;
          animation-duration: 1.1s;
      }

      @keyframes rad-fade-down {
          0% {
              opacity: 0;
              transform: translateY(-30px);
          }

          100% {
              opacity: 1;
              transform: translateY(0);
          }
      }

      
      .rad-scale-down {
          will-change: opacity, transform;
          animation-name: rad-scale-down-fallback;
          animation-duration: 5s;
          animation-fill-mode: both;
          transform-origin: 50% 0;
      }

      @keyframes rad-scale-down-fallback {
          0% {
              opacity: 0;
              transform: scaleY(0.95);
          }

          75% {
              opacity: 0;
              transform: scaleY(0.95);
          }

          100% {
              opacity: 1;
              transform: scaleY(1);
          }
      }

      .fonts-loaded .rad-scale-down.rad-waiting {
          animation-name: none;
          opacity: 0;
          transform: scaleY(0.95);
      }

      .fonts-loaded .rad-scale-down.rad-animate {
          animation-name: rad-scale-down;
          animation-duration: 1.1s;
          animation-fill-mode: both;
      }

      @keyframes rad-scale-down {
          0% {
              opacity: 0;
              transform: scaleY(0.95);
          }

          100% {
              opacity: 1;
              transform: scaleY(1);
          }
      
      }
      
      
  </style>





</head>

<body>

	<header class="header fixed-top rad-animation-group" id="header">
    <div class="container rad-fade-in">
      <nav class="navbar navbar-expand-lg navbar-light p-0">
        <a class="navbar-brand" href="index.html">
          <span style="font-size: 24px;">Yuwen</span>
          <span style="font-size: 24px;">Qin</span>
          
          
          
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarSupportedContent, #header"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ml-lg-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">主页</a>
            </li>
            
            <li class="nav-item">
              <a data-scroll class="nav-link" href="#about">技能</a>
            </li>
            
            <li class="nav-item">
              <a data-scroll class="nav-link" href="#portfolio">我的实践</a>
            </li>
            
            <!-- <li class="nav-item">
              <a data-scroll class="nav-link" href="#mytestimony">行业口碑</a>
            </li> -->

            
          </ul>
        </div>
      </nav>
    </div>
  </header>

	



	
	
<section class="section">
  <div class="container">
    
    <div class="row row--padded rad-animation-group rad-fade-down flex-column-reverse flex-md-row">
      <div class="col-12 col-md-5 mt-4 mt-md-0 my-md-auto">
        <span class="badge-2 rounded-pill" style="background-color:#D8D5FF!important;">编程</span>
        <span class="badge-2 rounded-pill" style="background-color:#D8D5FF!important;">用户研究</span>
        <h3 style="margin-top: 16px;">Python批量处理生命力评估模型</h3>
        <p class="lead">
          2020年1月 - 2020年4月<br/>
          码农<br/>
          本文阅读大约需要 8 mins
        </p>
      </div>
      <div class="col-12 col-md-7 pl-md-0 text-right">
        <img
          class='lozad img-responsive img-clip-left-backward'
          src="data:image/gif;base64,R0lGODlhBwACAIAAAP///wAAACH5BAEAAAEALAAAAAAHAAIAAAIDjI9YADs="
          data-src="img/project5/Background Copy.png"
          data-srcset="img/project5/Background Copy.png 1x, img/project5/Background Copy@2x.png 2x"
          alt="This is banner."
        />
      </div>
    </div>

  </div>
</section>

<section class="section" style="margin-top: 0px;">
  <div class="container">
    
    <div class="row row--padded rad-animation-group rad-fade-down flex-column-reverse flex-md-row" style="margin-top: 0px;">
      <div class="col-12 mt-4 mt-md-0 my-md-auto">
        <div>
          <div class="titlenumber">01</div>
          <div class="sectiontitle">写在前面的话</div>
          <div class="sectiontitle-eng">Perface</div>
        </div>
        
        <div class="title4">尝试的初衷与契机</div>
        <p class="lead">
          作为一个理科生，常常会思考，身处在Fintech行业，投资可以量化，图像可学习，万物可AI智能，Coding的心蠢蠢欲动。体验除了从表现层可以给用户带来直观的感受，直观的变化，成就某个惊艳的瞬间。还有没有更科学的方式助力体验提升，在用户看不见的地方，默默进行学习、洞察与提升，及预测。体验度量未来会不会AI化，智能化是否会成为新的方向。<br/>
          <br/>
          带着这些疑问，观察团队之中周期性项目中，发现生命力评估项目便是一个绝佳的可尝试的项目。所以才会有了这次写代码的机会… … 好奇是一切的驱动力，为了这次尝试，也向公司的各位AI技术大神，没少请教。事实证明，新的尝试永远都会有新的收获。未知的领域有很多。学，无止境。更要对未知有谦虚、省慎与敬畏之心。</p>
      </div>
    </div>

  </div>
</section>

<section class="section" style="margin-top: 0px;">
  <div class="container">
    
    <div class="row row--padded rad-animation-group rad-fade-down flex-column-reverse flex-md-row" style="margin-top: 0px;">
      <div class="col-12 mt-4 mt-md-0 my-md-auto">
        <div>
          <div class="titlenumber">02</div>
          <div class="sectiontitle">生命力评估模型</div>
          <div class="sectiontitle-eng">scale modeling</div>
        </div>
        
        <div class="title4">什么是生命力评估模型</div>
        <p class="lead">
          众所周知，体验设计处于艺术，心理，技术结合的交叉领域，做量化是相对困难的。生命力评估度量体系是2019年体验团队，结合APP用户使用经验，在Google Heart模型基础上，结合平安特色总结的APP四度用户体验度量框架模型。运用专家经验和量化指标，科学评估及量化集团各系列移动APP产品与市场竞品APP的差异，发现各条线移动APP体验提升优化点。并在后续不断深化精进的度量模型。成功地帮助团队，有序地进行各条线APP体验评估工作及发现体验洞察。
        </p>
        <img class="imgstyle" src="img/project5/Group 64.svg">
        <div class="imgsubtitle">CIO生命力评估“价”专家评估四度指标因子表</div>
        <div class="title4">生命力评估模型公式</div>
        <p class="lead">
          生命力评估模型公式主要使用到几何平均数，使用该公式可使得受极端值影响更小点，得到的结论更科学。对公式的优化也在不断持续进行。
        </p>
        <img class="imgstyle" src="img/project5/Group 11.svg">
        <div class="imgsubtitle">APP生命力计算体系</div>
        <img class="imgstyle" src="img/project5/Group 12.svg">
        <div class="imgsubtitle">APP生命力评估量表示例</div>
        <div class="title4">测试方法</div>
        <p class="lead">
          条线APP产品与竞品组合成为测试样本组，每组邀请六位专家进行量表测评。专家的组成也由团队中的用研、交互以及视觉同事组成。同时邀请用户参与量表评测。根据专家评估表中的主要功能和主要测评任务，完成主要测评任务。体验完主要测评任务后，进入打分环节，对应专家评估表的条目进行打分。对差评分数进行特别说明及评价。<br/>
          <br/>
          受邀测试完成后，由用户研究同事集齐所有量表。进行数据处理以及进行归纳总结。形成生命力评估报告，以得出专业中肯的体验提升洞察。
        </p>
        <img class="imgstyle" src="img/project5/Group 13.svg">
        <div class="imgsubtitle">某季度评估结果示例（本图显示为虚构数据）</div>
        <img class="imgstyle" src="img/project5/Group 14.svg">
        <div class="imgsubtitle">某产品按用户反馈及量表得分进行归因（本图显示为虚构数据）</div>
        <img class="imgstyle" src="img/project5/Group 15.svg">
        <div class="imgsubtitle">对往期数据进行回观，且进行趋势分析及数据可视化，形成体验洞察（本图显示为虚构数据）</div>
        <div class="title4">带来的问题</div>
        <p class="lead">
          在周期性为集团各条线进行测评过程中也发现了诸多问题。首先，测试样本量会增加，受测产品及竞品规模扩大，手动收集及计算过程将会变得冗长，无疑会加大数据分析的难度，降低测评的准确性。其次，数据无法结构化存储，仅存于本地，限制了数据同步、交接与共享。另外，数据分析的可视化呈现方式有限。
        </p>
        <img class="imgstyle" src="img/project5/Group 16.svg">
        <div class="imgsubtitle">实践过程与之而来发现的问题</div>
        <div class="title4">新的数据处理尝试</div>
        <p class="lead">
          运用学习了新的数据分析方法，尝试新的数据分析方法，首先可以拓宽数据分析的形式，逐渐总结出最优的数据分析方式。有了基本的数据量后，未来可考虑大数据分析，对APP量表打分数据进行回归及预测，更好的拓宽团队知识储备与实践。其次运用Python可更好的进行数据分析可视化，更能体现数据之美。<br/>
          <br/>
          即便面对新工具已知的可能带来的问题，也不妨碍我们新尝试的步伐。因为尝试就意味着新的机会和学习。
        </p>
        <img class="imgstyle" src="img/project5/Group 17.svg">
        <div class="imgsubtitle">新工具运用优缺点对比</div>

      </div>
    </div>

  </div>
</section>

<section class="section" style="margin-top: 0px;">
  <div class="container">
    
    <div class="row row--padded rad-animation-group rad-fade-down flex-column-reverse flex-md-row" style="margin-top: 0px;">
      <div class="col-12 mt-4 mt-md-0 my-md-auto">
        <div>
          <div class="titlenumber">03</div>
          <div class="sectiontitle">如何实现</div>
          <div class="sectiontitle-eng">On air</div>
        </div>
        
        <div class="title4">工具介绍</div>
        <p class="lead">
          使用以python为主要语言，可结构化查看数据的数据分析编辑器Spyder，以及Robo 3T用于数据存储。
        </p>

        <img class="imgstyle" src="img/project5/Group 18.svg">
        <div class="imgsubtitle">分析工具展示</div>

      </div>
    </div>

  </div>
</section>


<section class="section" style="margin-top: 0px;">
  <div class="container">
    
    <div class="row row--padded rad-animation-group rad-fade-down flex-column-reverse flex-md-row" style="margin-top: 0px;">
      <div class="col-12 mt-4 mt-md-0 my-md-auto">
        <div>
          <div class="titlenumber">04</div>
          <div class="sectiontitle">SHOW ME THE CODE</div>
          <div class="sectiontitle-eng">programming</div>
        </div>
        
        <div class="title4">主要思路</div>
        <p class="lead">
          开始<br/>
          1） 引入模组 Pandas 和 Scipy 用于计算；引入模组OS 及 xlrd执行系统操作<br/>
          2）批量读取文件夹中提交的生命力评估量表结果<br/>
          3）去除文件夹中无关的文件，避免扰乱计算结果，例如.ds的文档<br/>
          4）定义一个名为caculate的函数：执行读取量表中的数据，并进行计算，运算出结果。<br/>
          5）循环读取文件中的每个文件夹，运算caculate函数<br/>
          6）写入某文件<br/>
          7）将数据写入数据库<br/>
          结束
        </p>
        <div style="background-color: mintcream;padding-left: 80px;padding-right: 80px;margin-top: 40px;">
          <pre><code>
            import pandas as pd 
            from scipy import stats #算几何平均数
            import os
            import xlrd
            
            filename=os.listdir('url') #读取文件夹的内容
            filename.remove('.DS_Store') #去除文件夹中的无关文件
            
            def caculate(): # 定义单个文件相关数据的计算的函数
                for i in range(2):
                    sheet=data.sheet_by_index(i)#读每页
                    grade=sheet.col_values(8)#读第8列
                    average={'Validation':stats.gmean(grade[7:13]), #计算每页相关数据的几何平均数
                             'Efficiency':stats.gmean(grade[13:28]),
                             'Tolerance':stats.gmean(grade[28:32]),
                             'Satisfaction':stats.gmean(grade[32:42])}
                    totalpoints=pd.DataFrame(average,index=['%s Geometric Mean Value'%(label[i])]).T # 进行转制
                    print(totalpoints)
                    print('Total Points:            %s'%(stats.gmean(totalpoints)))
                    
            for j in range(len(filename)):
                data=xlrd.open_workbook('/Users/r李恩琪/Desktop/Py/生命力评估python练习/结果文件/%s'%filename[j]) #读文件
                label=data.sheet_names()
                print(filename[j])
                caculate()
                print()
                print()
          </code></pre>
        </div>
        <div class="imgsubtitle">按照执行思路写计算代码</div>


        <div style="background-color: mintcream;padding-left: 80px;padding-right: 80px;margin-top: 40px;">
          <pre><code>
            import requests
            from bs4 import BeautifulSoup
            #import pandas as pd
            import time
            import pymongo

            myclient=pymongo.MongoClient("mongodb://localhost:27017/")
            db=myclient['file_name']
            datatable=db['test']

            #result=[]
            for i in range(1,10): 
                web=requests.get('url'+str(i)+'&navigation=last&dateRange=0')
                soup=BeautifulSoup(web.text,'lxml')
                list=soup.find_all('div',class_="result-info")
                for li in list:
                    dic={}
                    dic['标题']=li.h4.text.replace('\nReport\n','').replace('\n','')
                    datatable.insert_one(dic)
            #        result.append(dic)
                s = requests.session() 
                #http连接太多没有关闭导致的，requests使用了urllib3库，默认的http connection是keep-alive的，requests设置False关闭。
                s.keep_alive = False
                time.sleep(5)
                    
            #result
          </code></pre>
        </div>
        <div class="imgsubtitle">数据入库代码</div>

        <img class="imgstyle" src="img/project5/Group 19.svg">
        <div class="imgsubtitle">入库数据结果</div>

      </div>
    </div>

  </div>
</section>


<section class="section" style="margin-top: 0px;">
  <div class="container">
    
    <div class="row row--padded rad-animation-group rad-fade-down flex-column-reverse flex-md-row" style="margin-top: 0px;">
      <div class="col-12 mt-4 mt-md-0 my-md-auto">
        <div>
          <div class="titlenumber">05</div>
          <div class="sectiontitle">尝试的总结</div>
          <div class="sectiontitle-eng">results</div>
        </div>
        
        <div class="title4">工具革新提高生产力的结果</div>
        <p class="lead">
          按照设想，在此次工具革新提高生产力的尝试中，取得了不俗的成绩。数据处理过程可以将更多的注意力集中至样表结果的搜集过程，以提高数据的准确性。收集完毕后，自动运行程序。可自动化数据处理过程，大大缩短了数据分析的过程，提高了分析的质量。最重要的是，写代码过程中遇到的难题及代码本身也成为团队知识沉淀，也为体验大数据化与AI化，提供了新的可能。
        </p>


      </div>
    </div>

  </div>
</section>







<section class="section" style="margin-top: 80px; margin-bottom: 100px;">
  <div class="container">
    <a type="button" class="btn btn-primary btn-lg buttom-link" style="float: left;width: 340px;height: 80px;" href="project4.html">上一篇：PC语音输入方案可用性测试及设计提升</a>
    <a type="button" class="btn btn-primary btn-lg buttom-link" style="float: right;width: 340px;height: 80px;"href="project6.html">下一篇：毕业设计 - 基于体感技术的残障人士产品服务系统研究</a></div>
</section>





	

<footer class="footer">
  <div class="container">
    <div class="footer__left">
      <div class="footer__copy">
        Designed and coded by Yuwen. All rights reserved.
      </div>
    </div>
    <div class="footer__links">
      <ul class="navbar-nav ">
        <li class="nav-item">
          <a class="nav-link" href="index.html">主页</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="#about">技能</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="#portfolio">我的实践</a>
        </li>
        
        <!-- <li class="nav-item">
          <a class="nav-link" href="#myfriend">行业口碑</a>
        </li> -->
        
      </ul>
    </div>
  </div>
</footer>

<script src='js/rad-animations.js'></script>
<script src='js/library/lozad.min.js'></script>
<script>
  window.addEventListener("load", function() {
    var observer = window.lozad(".lozad", {
      rootMargin: window.innerHeight / 2 + "px 0px",
      threshold: 0.01
    }); 
    observer.observe();
  });
</script>
<script src='js/library/jquery-3.3.1.slim.min.js'></script>
<script src='js/library/bootstrap.min.js'></script>
<script src='js/sticky-header.js'></script>
<script src='js/library/smooth-scroll.polyfills.min.js'></script>
<script src='js/library/fontfaceobserver.js'></script>
<script>
  (function(w) {
    
    if (w.document.documentElement.className.indexOf("fonts-loaded") > -1) {
      return;
    }
    var fontA = new w.FontFaceObserver("Inter", {
      weight: 300
    });
    var fontB = new w.FontFaceObserver("Inter", {
      weight: 400
    });
    var fontC = new w.FontFaceObserver("Inter", {
      weight: 500
    });
    var fontD = new w.FontFaceObserver("Inter", {
      weight: 600
    });
    var fontE = new w.FontFaceObserver("Inter", {
      weight: 700
    });
    var fontF = new w.FontFaceObserver("Inter", {
      weight: 900
    });
    w.Promise.all([fontA.load(), fontC.load(), fontF.load()]).then(function() {
      w.document.documentElement.className += " fonts-loaded";
    });
  })(this);
</script>
<script>
  const scroll = new SmoothScroll('a[href*="#"]');
    $('a.nav-link').on('click', () => {
      const navbar = $('.navbar-collapse');
      if (navbar && navbar.hasClass('show')) {
        $('.navbar-toggler').click();
      }
    })
</script>

</body>

</html>
